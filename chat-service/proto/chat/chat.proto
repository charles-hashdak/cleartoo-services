// chat-service/proto/chat/chat.proto

syntax = "proto3";

package chat;

option go_package = "proto/chat";

service ChatService{
	rpc Send(Chat) returns (SendResponse){}
	rpc GetChat(GetChatRequest) returns (GetChatResponse){}
	rpc GetConversations(GetConversationsRequest) returns (GetConversationsResponse){}
}

message Chat{
	string id = 1;
	string sender_id = 2;
	string receiver_id = 3;
	string message = 4;
	string send_at = 5;
	Product product = 6;
}

message Conversation{
	string sender_id = 1;
	string receiver_id = 2;
	string username = 3;
	Photo avatar = 4;
	string last_chat = 5;
	string send_at = 6;
	Product product = 7;
}

message Product{
	string id = 1;
	bool disponible = 2;
	string title = 3;
	int32 price = 4;
	Photo photo = 5;
}

message Photo{
	string id = 1;
	string url = 2;
	bool is_main = 3;
	int32 height = 4;
	int32 width = 5;
}

message SendRequest{
	Chat chat = 1;
}

message SendResponse{
	bool sent = 1;
}

message GetChatRequest{
	string sender_id = 1;
	string receiver_id = 2;
	string product_id = 3;
}

message GetChatResponse{
	repeated Chat chats = 1;
}

message GetConversationsRequest{
	string user_id = 1;
}

message GetConversationsResponse{
	repeated Conversation conversations = 1;
}